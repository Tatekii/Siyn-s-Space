# æ¦‚è¿°
V8 æ˜¯ Google çš„å¼€æºé«˜æ€§èƒ½ JavaScript å’Œ WebAssembly å¼•æ“ï¼Œç”¨ C++ ç¼–å†™ã€‚å®ƒç”¨äº Chrome å’Œ Node.js ç­‰ã€‚
V8 ç¼–è¯‘å¹¶æ‰§è¡Œ JavaScript æºä»£ç ï¼Œå¤„ç†å¯¹è±¡çš„å†…å­˜åˆ†é…ï¼Œå¹¶åƒåœ¾å›æ”¶ä¸å†éœ€è¦çš„å¯¹è±¡ã€‚V8 çš„ Stop-the-worldã€åˆ†ä»£ã€å‡†ç¡®çš„åƒåœ¾å›æ”¶å™¨æ˜¯ V8 æ€§èƒ½çš„å…³é”®ä¹‹ä¸€ã€‚
[https://v8.dev/docs](https://v8.dev/docs)

## å…¶ä»–javascriptå¼•æ“
>chakra => IE9 => Edge
>javascriptCore => Webkit => Safari

# V8æ‰§è¡Œæµç¨‹
1. **Lexical Analysis**
	Converts source code into **tokens**
2. **Parsing**
	Converts tokens into **AST (Abstract Syntax Tree)**
3. **Bytecode Generation**
	AST is compiled into **bytecode** (by â­ï¸`Ignition` in V8)
4. **JIT Compilation & Optimization**
	Frequently used code is compiled into **optimized machine code** (by â­ï¸`TurboFan` in V8)	
		> machineCode can ğŸ’¦deoptimization to byteCode
5. **Execution**
	- Machine Code Runs on CPU
	- Garbage collection and memory handling
## æ³¨æ„ï¼š
1. å­—èŠ‚ç å¯ç›´æ¥è§£é‡Šæ‰§è¡Œï¼Œä½†æ‰§è¡Œæ•ˆç‡è¾ƒæœºå™¨ç æ…¢
2. æœºå™¨ç æ˜¯ç¡¬ä»¶å¯ç›´æ¥æ‰§è¡Œçš„ä½çº§ä»£ç 
3. ä»£ç æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå¦‚æœä¸Šè¿°é˜¶æ®µ4çš„ä¼˜åŒ–ä¸å†æœ‰æ•ˆæˆ–è€…æœ‰æ›´ä¼˜è·¯å¾„ï¼Œä¼šæ‰§è¡Œé€†ä¼˜åŒ–ï¼Œè¿˜åŸå‡ºå­—èŠ‚ç 

# V8çš„ä¸»è¦æ¨¡å—
## Parser **- Code Parser**
- Converts JavaScript **source code â†’ AST (Abstract Syntax Tree)**.
- Itâ€™s the **first step** before execution.
```json
// let x = 10; AST
{
  "type": "VariableDeclaration",
  "id": { "type": "Identifier", "name": "x" },
  "init": { "type": "Literal", "value": 10 }
}
```
## ğŸ”¥IgnitionÂ **- The Interpreter (Bytecode Engine)**
- **converts JavaScript into bytecode**.
- JavaScript source code â†’ **Lexing & Parsing** â†’ AST â†’ **Bytecode** (via Ignition)
- The bytecode is executed **immediately** and later optimized by the JIT compiler.
```assembly
0x12345678 @ 0 : LdaSmi 5
0x12345679 @ 2 : Star r0
0x12345680 @ 4 : Return
```
## ğŸŒ¬ï¸TurboFanÂ **- The Optimizing JIT Compiler**

- TurboFan is V8â€™s **Just-In-Time (JIT) compiler** that **optimizes** frequently executed code into **machine code**.
- If a function runs **frequently**, TurboFan **recompiles it into efficient machine code**.
- **If assumptions break** (e.g., type changes), it **de-optimizes back** to bytecode.
```javascript
function add(a, b) {
  return a + b;
}

add(2, 3); // Runs in Ignition first
add(4, 5); // Marked as "hot"
```
## ğŸ—ï¸Liftoff **- The WebAssembly Compiler**

## ğŸ§©Orinoco **- The Garbage Collector (ğŸ”¥GCğŸ”¥)**

## ğŸ’³Code Caching **- Optimizing Startup Time**
- Stores **compiled code** to **avoid recompilation** when JavaScript runs again.
- Used in **Chromeâ€™s V8 Cache** and **Service Workers**.

