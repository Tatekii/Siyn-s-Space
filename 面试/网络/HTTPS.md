## HTTPS

### TLS/SSl

- 传输层安全性协议（英语：Transport Layer Security，缩写作 TLS），及其前身安全套接层（Secure Sockets Layer，缩写作 SSL）是一种安全协议，目的是为互联网通信提供安全及数据完整性保障。

- TLS 协议的特点是与应用层协议（HTTP，FTP）无耦合，应用层协议能透明运行在 TLS 协议上层（HTTP 与 TCP 之间）
### 概念
- 【非对称加密】
只有使用私钥才能解开公钥加密
- 【摘要算法】
输出固定长度的数据，用来计算数据指纹，比如 SHA256
- 【数字签名】
使用私钥对摘要算法得出的指纹加密
### SSL 证书
- 证书包含以下信息：申请者公钥、申请者的组织信息和个人信息、签发机构 CA 的信息、有效时间、证书序列号，摘要算法等信息的明文

- CA 使用 CA 私钥对证书明文摘要算法后得出的指纹进行加密得到签名
### 浏览器验证证书合法性

1. 从操作系统中找到相应的`CA机构证书`

2. 使用`CA证书`的公钥解密`站点证书 `的`签名`得到校验码 1

3. 使用证书指定的摘要算法对`站点证书`明文计算得到校验码 2

4. 比较两个校验码相同则说明证书没被篡改

5. 后面就开始查看证书是否在有效期，是否对应当前域名，是否在吊销列表中等

### HTTPS 工作流程

1. 用户访问:443,发送客户端支持的加密算法列表和随机数`Random_C`

2. 服务器根据支持的算法计算并返回证书和随机数`Random_S`

3. 用户浏览器使用操作系统里的 **_CA 公钥_** 打开并验证证书的合法性得到证书中的 **_服务器公钥_**

4. 用户生成生新的随机数`Premaster secret`，并使用 **_服务器公钥_** 加密发送给服务器

5. 服务器使用自己的 **_服务器私钥_** 解密，得到 `Premaster secret`

6. 此后双方使用同样的加密算法对三个随机数进行计算得到对称的密钥`enc_key`

7. 至此双方得到了对称加密密钥,之后的连接都只使用对称加密

  